#include "llama/llama_fonts.h"

#include "bregs.h"   // struct bregs
#include "farptr.h"  // FLATPTR_TO_SEG, FLATPTR_TO_OFFSET
#include "stacks.h"  // call16_int
#include "string.h"  // memset
#include "types.h"

u8 llama_fonts[192] VARLOW = {
    0b00000100,
    0b00000110,
    0b00001111,
    0b00000111,
    0b00001111,
    0b00011111,
    0b00111111,
    0b00011111,
    0b00000011,
    0b00000001,
    0b00000001,
    0b00000001,
    0b00000001,
    0b00000001,
    0b00000001,
    0b00000001,

    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b10000000,
    0b10000000,
    0b10000000,
    0b10000000,
    0b10000000,
    0b11000000,
    0b11000000,
    0b11111100,
    0b11111111,
    0b11111111,
    0b11111111,
    0b11111111,

    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000001,
    0b00000011,
    0b00011111,
    0b11111111,
    0b11111111,
    0b11111111,
    0b11111111,

    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b11000000,
    0b11100000,
    0b11110000,
    0b11110000,
    0b11110000,
    0b11110000,

    0b00000001,
    0b00000001,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,

    0b11111111,
    0b11111111,
    0b11111111,
    0b11111111,
    0b01111111,
    0b00111111,
    0b00011110,
    0b00011110,
    0b00011110,
    0b00011110,
    0b00011110,
    0b00011110,
    0b00001110,
    0b00111110,
    0b00111110,
    0b00001100,

    0b11111111,
    0b11111111,
    0b11111111,
    0b11111111,
    0b11111111,
    0b11100111,
    0b00000011,
    0b00000011,
    0b00000011,
    0b00000110,
    0b00000110,
    0b00001100,
    0b00011100,
    0b00011001,
    0b00000001,
    0b00000000,

    0b11100000,
    0b11100000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b11000000,
    0b10000000,
    0b00000000,
    0b00000000,

    0b00000000,
    0b00000000,
    0b00110000,
    0b01111000,
    0b11111100,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,

    0b00000000,
    0b00000000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b00110000,
    0b11111100,
    0b01111000,
    0b00110000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,

    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00100000,
    0b01100000,
    0b11111111,
    0b11111111,
    0b01100000,
    0b00100000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,

    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000100,
    0b00000110,
    0b11111111,
    0b11111111,
    0b00000110,
    0b00000100,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
    0b00000000,
};

void load_custom_fonts(u8 *font_ptr, u16 ascii_position, u16 count)
{
  struct bregs br;
  memset(&br, 0, sizeof(br));
  br.flags = F_IF;
  br.ax = 0x1110;
  br.bh = 16;             // height of each character
  br.bl = 0;              // font block
  br.cx = count;          // how manay characters will be redefined?
  br.dx = ascii_position; // index of first character to be redefined
  br.es = FLATPTR_TO_SEG(font_ptr);
  br.bp = FLATPTR_TO_OFFSET(font_ptr);
  call16_int(0x10, &br);
}